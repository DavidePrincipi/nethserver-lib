Name: nethserver-lib
Summary: NethServer library module
Version: @@VERSION@@
Release: @@RELEASE@@
License: GPL
Source: %{name}-%{version}.tar.gz
BuildArch: noarch
URL: %{url_prefix}/%{name}

BuildRequires: nethserver-devtools
BuildRequires: perl, perl(File::Path)

Requires: dialog
Requires: perl, perl(Text::Template)
Requires: perl(Time::HiRes)
Requires: perl(Authen::PAM), perl(I18N::AcceptLanguage)
Requires: perl(I18N::LangTags) >= 0.27
Requires: perl(Net::IPv4Addr) >= 0.10
Requires: perl(MIME::Base64)
Requires: perl(Data::UUID)
Requires: perl-JSON
Requires: perl-Digest-SHA1

%description
Common script libraries for the e-smith system

%prep
%setup

%build
perl createlinks

# davidep: relocate perl modules under default perl vendorlib directory:
mkdir -p root%{perl_vendorlib}
mv -v esmith root%{perl_vendorlib}
mv -v NethServer root%{perl_vendorlib}

%install
rm -rf $RPM_BUILD_ROOT
(cd root ; find . -depth -not -name '*.orig' -print | cpio -dump $RPM_BUILD_ROOT)
rm -f %{name}-%{version}-%{release}-filelist
%{genfilelist} $RPM_BUILD_ROOT >%{name}-%{version}-%{release}-filelist
echo "%doc COPYING" >> %{name}-%{version}-%{release}-filelist

%clean
rm -rf $RPM_BUILD_ROOT

%files -f %{name}-%{version}-%{release}-filelist
%defattr(-,root,root)

%changelog
* Tue Apr 30 2013 Giacomo Sanchietti <giacomo.sanchietti@nethesis.it> - 1.1.1-1.ns6
- Rebuild for automatic package handling. #1870
- Read locale settings from /etc/sysconfig. Refs #1754

* Tue Mar 19 2013 Davide Principi <davide.principi@nethesis.it> - 1.1.0-1.ns6
- Added NethServer::Migrate module, for migration support. Refs #1690 #1655 #1657
- esmith::ConfigDB (wins_server): obsolete function returns always undef. Refs #7 #1081
- *.spec: use url_prefix macro in URL tag; update changelog for release 1.0.3-1. Refs #1654 

* Thu Feb 21 2013 Giacomo Sanchietti <giacomo.sanchietti@nethesis.it> 1.0.3-1.ns6
- util.pm: add genRandomHash function to generate random sha1 hash
- Update template-default with Nethesis copyright. Fix: #1649
 
* Mon Jan 21 2013 Davide Principi <davide.principi@nethesis.it> - 1.0.2-1.ns6
- DB/db.pm: fixed $initScript command execution. Only networks DB was actually initialized.

* Fri Jan 18 2013 Giacomo Sanchietti <giacomo.sanchietti@nethesis.it> - 1.0.1-1.ns6
- adjust-services: stop service if not enabled
- added a new getnRandomPassword function
- esmith/console.pm: read separate Version and Release props from key "sysconfig"
- Removed old LDAP libs (moved to nethserver-directory)

* Fri Dec 21 2012 Davice Principi <davide.principi@nethesis.it> - 1.0.0-1.ns6
- First release
